{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\nconst BASE = \"https://pixabay.com/api/\";\nconst API_KEY = \"49565039-11a2922cd8e7ceae59523da99\";\nconst limit = 15;\n\nexport async function getImagesByQuery(query, page) {\n    try{\n    console.log(\"Searching for:\", query);\n    \n    const response = await axios.get(BASE, {\n        params: {\n                    key: API_KEY,\n                    q: query,\n                    image_type: \"photo\",\n                    orientation: \"horizontal\",\n                    safesearch: true,\n                    page: page,\n                    per_page: limit,\n                },\n            });\n\n    console.log(\"Raw API response:\", response.data);\n\n\n    if (!response.data.hits || !Array.isArray(response.data.hits) || response.data.hits.length === 0) {\n        iziToast.error({\n            title: \"Error\",\n            message: \"Sorry, there are no images matching your search query. Please try again!\",\n        });\n        return { hits: [], totalHits: 0 };\n\n    }\n    return { hits: response.data.hits, totalHits: response.data.totalHits };   \n}\n\ncatch(error) {\n            console.error(\"Axios error:\", error);\n            iziToast.error({\n                title: \"Error\",\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n            });\n            return { hits: [], totalHits: 0 };\n        }\n}\n\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst lightbox = new SimpleLightbox(\".gallery a\", {\n    captionsData: 'alt',\n    captionsDelay: 250,\n});\n\nexport function createGallery(images){\n\n    const gallery = document.querySelector(\".gallery\");\n    \n\n    const markup = images\n       .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n    `<li class=\"gallery-item\">\n        <a href=\"${largeImageURL}\" class=\"gallery-link\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\"/>\n        </a>\n        <div class=\"description\">\n            <p><b>Likes:</b> ${likes}</p>\n            <p><b>Views:</b> ${views}</p>\n            <p><b>Comments:</b> ${comments}</p>\n            <p><b>Downloads:</b> ${downloads}</p>\n        </div>\n    </li>\n    `).join(\"\");\n\n    gallery.insertAdjacentHTML(\"beforeend\", markup);\n\n    lightbox.refresh();\n}\n\nexport function clearGallery(){\n    const gallery = document.querySelector(\".gallery\");\n    gallery.innerHTML = \"\";\n}\n\nexport function showLoader(){\n    const loader = document.querySelector(\".loader\");\n    loader.classList.add(\"visible\");\n}\n\nexport function hideLoader(){\n    const loader = document.querySelector(\".loader\");\n    loader.classList.remove(\"visible\");\n}\n\nexport function showLoadMoreButton(){\n    const loadMoreBtn = document.querySelector(\".load-more-btn\");\n    loadMoreBtn.style.display = \"block\";\n}\n\nexport function hideLoadMoreButton(){\n    const loadMoreBtn = document.querySelector(\".load-more-btn\");\n    loadMoreBtn.style.display = \"none\";\n}","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getImagesByQuery } from \"./js/pixabay-api.js\";\nimport { \n    clearGallery, \n    hideLoadMoreButton, \n    showLoader, \n    createGallery, \n    showLoadMoreButton, \n    hideLoader \n} from \"./js/render-functions.js\";\n\n\nlet searchQuery = \"\";\nlet page = 1;\nlet limit = 15;\nlet totalHits = 0;\n\n\nconst form = document.querySelector(\".form\");\nconst loadMoreBtn = document.querySelector(\".load-more-btn\");\nconst input = document.querySelector('input[name=\"search-text\"]');\n\nhideLoadMoreButton();\n\nform.addEventListener(\"submit\", async (event) => {\n    event.preventDefault();\n\n    searchQuery = input.value.trim();\n\n    if(!searchQuery)return;\n\n    page = 1;\n    totalHits = 0;\n    clearGallery();\n    hideLoadMoreButton(); \n    showLoader();\n\n    try{\n        const { hits, totalHits: fetchedTotalHits }  = await getImagesByQuery(searchQuery, page);\n\n        console.log(\"Total hits:\", fetchedTotalHits);\n\n        totalHits = fetchedTotalHits;\n\n        if (hits.length === 0) {\n            iziToast.error({\n                title: \"Error\",\n                message: \"No images found\",\n            });\n            return;\n        }\n\n        createGallery(hits);\n        checkLoadMoreButton();\n\n        handleScroll();\n        \n        \n    } catch(error) {\n        console.log(error);\n        iziToast.error({\n            title: \"Error\",\n            message: \"An error catched while finding images. Try again.\"\n        });\n    } finally {\n        hideLoader();\n    }\n});\n\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n    page += 1;\n    showLoader();\n\n    try {\n        const { hits } = await getImagesByQuery(searchQuery, page);\n        console.log(\"Full API Response:\", hits); \n\n        if(hits.length === 0){\n            iziToast.info({\n                title: \"No more images\",\n                message: \"No more images found for your request.\"\n            });\n\n            hideLoadMoreButton();\n            return;\n        }\n\n        createGallery(hits);\n        checkLoadMoreButton();\n\n        handleScroll();\n      \n    } catch (error){\n        console.log(\"Error:\", error);\n        \n        iziToast.error({\n            title: \"Error\",\n            message: \"An error catched while finding images. Try again.\"\n        });\n    } finally {\n        hideLoader();\n    }\n});\n\nfunction checkLoadMoreButton(){\n    const totalPages = Math.ceil(totalHits / limit);\n\n    if(page < totalPages){\n        showLoadMoreButton();\n    } else {\n        hideLoadMoreButton();\n        iziToast.success({\n            title: \"End of results\",\n            message: \"All pictures have been loaded\",\n        });\n    }\n}\n\nfunction handleScroll() {\n    const lastImage = document.querySelector(\".gallery\")?.lastElementChild;\n    if (lastImage) {\n        setTimeout(() => {\n            lastImage.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n        }, 700); \n    }\n}\n\n"],"names":["BASE","API_KEY","limit","getImagesByQuery","query","page","response","axios","iziToast","error","lightbox","SimpleLightbox","createGallery","images","gallery","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","loadMoreBtn","hideLoadMoreButton","searchQuery","totalHits","form","input","event","hits","fetchedTotalHits","checkLoadMoreButton","handleScroll","totalPages","lastImage","_a"],"mappings":"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"}